<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HRD Learning & KPI System ‚Äî MedDevice Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Prompt:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0f1e;
    --bg2: #111827;
    --card: #161d2f;
    --card2: #1e2942;
    --border: #2a3554;
    --accent: #00d4ff;
    --accent2: #7c3aed;
    --accent3: #10b981;
    --accent4: #f59e0b;
    --accent5: #ef4444;
    --text: #e2e8f0;
    --text2: #94a3b8;
    --text3: #64748b;
    --glow: 0 0 20px rgba(0,212,255,0.15);
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'Sarabun', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }
  /* Animated background */
  body::before {
    content:'';
    position:fixed; inset:0;
    background: 
      radial-gradient(ellipse 80% 60% at 20% 10%, rgba(0,212,255,0.06) 0%, transparent 60%),
      radial-gradient(ellipse 60% 50% at 80% 80%, rgba(124,58,237,0.06) 0%, transparent 60%);
    pointer-events:none; z-index:0;
  }

  /* SIDEBAR */
  .sidebar {
    position:fixed; left:0; top:0; bottom:0; width:240px;
    background: var(--card);
    border-right: 1px solid var(--border);
    z-index:100;
    display:flex; flex-direction:column;
  }
  .logo {
    padding:24px 20px;
    border-bottom:1px solid var(--border);
  }
  .logo-badge {
    display:inline-block;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color:#fff; font-family:'Prompt',sans-serif; font-weight:700;
    font-size:11px; letter-spacing:2px;
    padding:3px 8px; border-radius:4px; margin-bottom:8px;
  }
  .logo h1 { font-family:'Prompt',sans-serif; font-size:18px; font-weight:700; line-height:1.2; }
  .logo p { font-size:11px; color:var(--text2); margin-top:4px; }

  .nav { flex:1; padding:16px 0; overflow-y:auto; }
  .nav-section { padding:0 16px 4px; font-size:10px; letter-spacing:2px; color:var(--text3); text-transform:uppercase; margin-top:12px; }
  .nav-item {
    display:flex; align-items:center; gap:10px;
    padding:10px 16px; margin:2px 8px; border-radius:8px;
    cursor:pointer; font-size:14px; color:var(--text2);
    transition:all 0.2s;
  }
  .nav-item:hover { background:var(--card2); color:var(--text); }
  .nav-item.active { background:linear-gradient(135deg,rgba(0,212,255,0.15),rgba(124,58,237,0.1)); color:var(--accent); border:1px solid rgba(0,212,255,0.2); }
  .nav-item .icon { font-size:16px; width:20px; text-align:center; }
  .nav-badge { margin-left:auto; background:var(--accent5); color:#fff; font-size:10px; padding:1px 6px; border-radius:10px; }

  .sidebar-footer { padding:16px; border-top:1px solid var(--border); }
  .user-card { display:flex; align-items:center; gap:10px; }
  .avatar { width:36px; height:36px; border-radius:50%; background:linear-gradient(135deg,var(--accent),var(--accent2)); display:flex; align-items:center; justify-content:center; font-weight:700; font-size:13px; }
  .user-info p:first-child { font-size:13px; font-weight:600; }
  .user-info p:last-child { font-size:11px; color:var(--text2); }

  /* MAIN */
  .main { margin-left:240px; min-height:100vh; position:relative; z-index:1; }
  .topbar {
    position:sticky; top:0; z-index:50;
    background:rgba(10,15,30,0.8); backdrop-filter:blur(12px);
    border-bottom:1px solid var(--border);
    padding:16px 32px;
    display:flex; align-items:center; justify-content:space-between;
  }
  .topbar h2 { font-family:'Prompt',sans-serif; font-size:20px; font-weight:700; }
  .topbar-right { display:flex; align-items:center; gap:12px; }
  .btn {
    padding:8px 16px; border-radius:8px; border:none; cursor:pointer;
    font-family:'Sarabun',sans-serif; font-size:13px; font-weight:600;
    transition:all 0.2s;
  }
  .btn-primary { background:linear-gradient(135deg,var(--accent),#0099cc); color:#000; }
  .btn-primary:hover { transform:translateY(-1px); box-shadow:0 4px 15px rgba(0,212,255,0.4); }
  .btn-ghost { background:transparent; color:var(--text2); border:1px solid var(--border); }
  .btn-ghost:hover { border-color:var(--accent); color:var(--accent); }

  /* CONTENT */
  .content { padding:32px; }
  .page { display:none; }
  .page.active { display:block; animation:fadeIn 0.3s ease; }
  @keyframes fadeIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)} }

  /* DASHBOARD PAGE */
  .stats-grid { display:grid; grid-template-columns:repeat(4,1fr); gap:16px; margin-bottom:24px; }
  .stat-card {
    background:var(--card);
    border:1px solid var(--border);
    border-radius:12px; padding:20px;
    position:relative; overflow:hidden;
    transition:transform 0.2s, box-shadow 0.2s;
  }
  .stat-card:hover { transform:translateY(-2px); box-shadow:var(--glow); }
  .stat-card::before {
    content:''; position:absolute; top:0; left:0; right:0; height:3px;
  }
  .stat-card.blue::before { background:linear-gradient(90deg,var(--accent),#0077ff); }
  .stat-card.purple::before { background:linear-gradient(90deg,var(--accent2),#a855f7); }
  .stat-card.green::before { background:linear-gradient(90deg,var(--accent3),#34d399); }
  .stat-card.amber::before { background:linear-gradient(90deg,var(--accent4),#fbbf24); }
  .stat-label { font-size:12px; color:var(--text2); margin-bottom:8px; }
  .stat-val { font-family:'Prompt',sans-serif; font-size:28px; font-weight:800; }
  .stat-sub { font-size:12px; color:var(--text3); margin-top:4px; }
  .stat-icon { position:absolute; right:16px; top:50%; transform:translateY(-50%); font-size:32px; opacity:0.15; }

  .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:24px; }
  .grid-3 { display:grid; grid-template-columns:2fr 1fr; gap:16px; margin-bottom:24px; }

  .card {
    background:var(--card);
    border:1px solid var(--border);
    border-radius:12px; padding:20px;
  }
  .card-title { font-family:'Prompt',sans-serif; font-size:15px; font-weight:700; margin-bottom:16px; display:flex; align-items:center; gap:8px; }
  .card-title span { font-size:16px; }

  /* KPI Gauge */
  .kpi-gauge-wrap { display:flex; flex-direction:column; align-items:center; padding:8px 0; }
  .gauge-svg { width:160px; height:90px; }
  .gauge-val { font-family:'Prompt',sans-serif; font-size:32px; font-weight:800; text-align:center; margin-top:-8px; }
  .gauge-label { font-size:12px; color:var(--text2); text-align:center; }

  /* KPI Breakdown */
  .kpi-row { display:flex; align-items:center; gap:12px; margin-bottom:12px; }
  .kpi-label { font-size:13px; width:160px; flex-shrink:0; }
  .kpi-bar-wrap { flex:1; height:8px; background:var(--bg2); border-radius:4px; overflow:hidden; }
  .kpi-bar { height:100%; border-radius:4px; transition:width 1s ease; }
  .kpi-score { font-size:13px; font-weight:700; width:40px; text-align:right; }
  .kpi-weight { font-size:11px; color:var(--text3); width:32px; text-align:right; }

  /* Employee Table */
  .table-wrap { overflow-x:auto; }
  table { width:100%; border-collapse:collapse; font-size:13px; }
  th { text-align:left; padding:10px 12px; color:var(--text2); font-weight:600; font-size:11px; text-transform:uppercase; letter-spacing:1px; border-bottom:1px solid var(--border); }
  td { padding:12px; border-bottom:1px solid rgba(42,53,84,0.5); }
  tr:hover td { background:rgba(255,255,255,0.02); }
  .rank-badge { width:24px; height:24px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-weight:700; font-size:11px; }
  .rank-1 { background:linear-gradient(135deg,#f59e0b,#fbbf24); color:#000; }
  .rank-2 { background:linear-gradient(135deg,#94a3b8,#cbd5e1); color:#000; }
  .rank-3 { background:linear-gradient(135deg,#b45309,#d97706); color:#fff; }
  .rank-other { background:var(--bg2); color:var(--text2); }
  .score-pill { padding:2px 8px; border-radius:20px; font-size:12px; font-weight:700; }
  .score-high { background:rgba(16,185,129,0.15); color:var(--accent3); }
  .score-mid { background:rgba(245,158,11,0.15); color:var(--accent4); }
  .score-low { background:rgba(239,68,68,0.15); color:var(--accent5); }
  .progress-mini { width:80px; height:6px; background:var(--bg2); border-radius:3px; overflow:hidden; }
  .progress-mini-bar { height:100%; border-radius:3px; }

  /* LEARNING PAGE */
  .category-tabs { display:flex; gap:8px; margin-bottom:24px; flex-wrap:wrap; }
  .tab { padding:8px 16px; border-radius:8px; border:1px solid var(--border); background:transparent; color:var(--text2); cursor:pointer; font-family:'Sarabun',sans-serif; font-size:13px; font-weight:600; transition:all 0.2s; }
  .tab.active { background:linear-gradient(135deg,rgba(0,212,255,0.15),rgba(124,58,237,0.1)); color:var(--accent); border-color:rgba(0,212,255,0.3); }
  .tab:hover { border-color:var(--accent); color:var(--accent); }

  .courses-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:16px; }
  .course-card {
    background:var(--card); border:1px solid var(--border); border-radius:12px;
    overflow:hidden; cursor:pointer; transition:all 0.2s;
  }
  .course-card:hover { transform:translateY(-3px); box-shadow:0 8px 24px rgba(0,0,0,0.3); border-color:rgba(0,212,255,0.2); }
  .course-thumb {
    height:100px;
    display:flex; align-items:center; justify-content:center;
    font-size:40px; position:relative; overflow:hidden;
  }
  .course-thumb::before { content:''; position:absolute; inset:0; }
  .thumb-blue::before { background:linear-gradient(135deg,#0a1929,#0d2040); }
  .thumb-purple::before { background:linear-gradient(135deg,#1a0a29,#2d1040); }
  .thumb-green::before { background:linear-gradient(135deg,#0a1a0f,#0d291a); }
  .thumb-amber::before { background:linear-gradient(135deg,#1a140a,#29200d); }
  .thumb-icon { position:relative; z-index:1; }
  .course-body { padding:14px; }
  .course-category { font-size:10px; letter-spacing:1px; text-transform:uppercase; color:var(--accent); margin-bottom:6px; }
  .course-title { font-size:14px; font-weight:700; margin-bottom:8px; line-height:1.3; }
  .course-meta { display:flex; align-items:center; gap:12px; font-size:11px; color:var(--text2); margin-bottom:10px; }
  .course-progress { display:flex; align-items:center; gap:8px; }
  .course-progress-bar { flex:1; height:4px; background:var(--bg2); border-radius:2px; overflow:hidden; }
  .course-progress-fill { height:100%; border-radius:2px; }
  .course-progress-pct { font-size:11px; font-weight:700; }
  .status-badge { font-size:10px; padding:2px 8px; border-radius:10px; font-weight:600; }
  .status-done { background:rgba(16,185,129,0.15); color:var(--accent3); }
  .status-in { background:rgba(0,212,255,0.15); color:var(--accent); }
  .status-new { background:rgba(100,116,139,0.15); color:var(--text2); }

  /* QUIZ MODAL */
  .modal-overlay {
    position:fixed; inset:0; background:rgba(0,0,0,0.7); backdrop-filter:blur(4px);
    z-index:200; display:none; align-items:center; justify-content:center;
  }
  .modal-overlay.open { display:flex; }
  .modal {
    background:var(--card2); border:1px solid var(--border); border-radius:16px;
    width:600px; max-height:80vh; overflow-y:auto; padding:32px;
    animation:slideUp 0.3s ease;
  }
  @keyframes slideUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
  .modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:24px; }
  .modal-header h3 { font-family:'Prompt',sans-serif; font-size:18px; font-weight:700; }
  .close-btn { background:none; border:none; color:var(--text2); font-size:20px; cursor:pointer; }
  .quiz-q { font-size:15px; font-weight:600; margin-bottom:16px; line-height:1.5; }
  .quiz-opts { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
  .quiz-opt {
    padding:12px 16px; border-radius:8px; border:1px solid var(--border);
    cursor:pointer; font-size:14px; transition:all 0.2s; display:flex; align-items:center; gap:10px;
  }
  .quiz-opt:hover { border-color:var(--accent); background:rgba(0,212,255,0.05); }
  .quiz-opt.selected { border-color:var(--accent); background:rgba(0,212,255,0.1); color:var(--accent); }
  .quiz-opt.correct { border-color:var(--accent3); background:rgba(16,185,129,0.1); color:var(--accent3); }
  .quiz-opt.wrong { border-color:var(--accent5); background:rgba(239,68,68,0.1); color:var(--accent5); }
  .opt-circle { width:22px; height:22px; border-radius:50%; border:2px solid currentColor; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; flex-shrink:0; }
  .quiz-progress { display:flex; align-items:center; gap:12px; margin-bottom:20px; }
  .quiz-progress-bar { flex:1; height:6px; background:var(--bg); border-radius:3px; overflow:hidden; }
  .quiz-progress-fill { height:100%; background:linear-gradient(90deg,var(--accent),var(--accent2)); border-radius:3px; transition:width 0.3s; }
  .quiz-nav { display:flex; justify-content:space-between; align-items:center; }
  .quiz-result { text-align:center; padding:24px; }
  .result-score { font-family:'Prompt',sans-serif; font-size:64px; font-weight:800; margin-bottom:8px; }
  .result-pass { color:var(--accent3); }
  .result-fail { color:var(--accent5); }

  /* KPI CALCULATOR */
  .kpi-calc-grid { display:grid; grid-template-columns:1fr 1fr; gap:24px; }
  .input-group { margin-bottom:16px; }
  .input-label { font-size:12px; color:var(--text2); margin-bottom:6px; font-weight:600; }
  .input-row { display:flex; align-items:center; gap:8px; }
  .input-field {
    flex:1; background:var(--bg2); border:1px solid var(--border); border-radius:8px;
    padding:10px 12px; color:var(--text); font-family:'Sarabun',sans-serif; font-size:14px;
    outline:none; transition:border 0.2s;
  }
  .input-field:focus { border-color:var(--accent); }
  .input-weight { font-size:12px; color:var(--text3); width:40px; text-align:right; }
  .kpi-result-big {
    background:linear-gradient(135deg,rgba(0,212,255,0.1),rgba(124,58,237,0.1));
    border:1px solid rgba(0,212,255,0.2);
    border-radius:12px; padding:24px; text-align:center; margin-top:16px;
  }
  .kpi-result-num { font-family:'Prompt',sans-serif; font-size:56px; font-weight:800; }
  .kpi-result-label { font-size:14px; color:var(--text2); margin-top:4px; }
  .kpi-grade { font-size:20px; font-weight:700; margin-top:8px; }
  .bonus-calc { background:var(--bg2); border-radius:8px; padding:16px; margin-top:16px; }
  .bonus-row { display:flex; justify-content:space-between; font-size:13px; padding:4px 0; }
  .bonus-total { border-top:1px solid var(--border); margin-top:8px; padding-top:8px; font-weight:700; font-size:15px; }

  /* GUIDE PAGE */
  .guide-steps { display:flex; flex-direction:column; gap:0; }
  .step {
    display:flex; gap:20px; padding:24px 0;
    border-bottom:1px solid var(--border); position:relative;
  }
  .step:last-child { border-bottom:none; }
  .step-num-wrap { display:flex; flex-direction:column; align-items:center; }
  .step-num {
    width:40px; height:40px; border-radius:50%; flex-shrink:0;
    display:flex; align-items:center; justify-content:center;
    font-family:'Prompt',sans-serif; font-weight:700; font-size:16px;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:#000;
  }
  .step-line { width:2px; flex:1; background:var(--border); margin-top:8px; }
  .step-content { flex:1; padding-bottom:8px; }
  .step-header { display:flex; align-items:center; gap:10px; margin-bottom:8px; }
  .step-title { font-family:'Prompt',sans-serif; font-size:16px; font-weight:700; }
  .step-tool {
    font-size:11px; padding:2px 8px; border-radius:4px;
    background:rgba(0,212,255,0.1); color:var(--accent); border:1px solid rgba(0,212,255,0.2);
  }
  .step-body { font-size:14px; color:var(--text2); line-height:1.8; }
  .step-body ul { margin:8px 0 0 16px; }
  .step-body li { margin-bottom:4px; }
  .code-block {
    background:var(--bg); border:1px solid var(--border); border-radius:8px;
    padding:12px 16px; font-family:monospace; font-size:13px; color:var(--accent3);
    margin-top:12px; overflow-x:auto;
  }

  /* HEATMAP */
  .heatmap-grid { display:grid; grid-template-columns:repeat(6,1fr); gap:4px; }
  .heat-cell {
    aspect-ratio:1; border-radius:4px; display:flex; align-items:center; justify-content:center;
    font-size:10px; font-weight:700; cursor:pointer; transition:transform 0.2s;
  }
  .heat-cell:hover { transform:scale(1.1); }
  .heat-0 { background:rgba(42,53,84,0.5); color:var(--text3); }
  .heat-1 { background:rgba(16,185,129,0.2); color:var(--accent3); }
  .heat-2 { background:rgba(16,185,129,0.4); color:var(--accent3); }
  .heat-3 { background:rgba(16,185,129,0.7); color:#000; }
  .heat-legend { display:flex; align-items:center; gap:6px; margin-top:8px; font-size:11px; color:var(--text2); }
  .heat-dot { width:12px; height:12px; border-radius:2px; }

  /* Notification dot */
  .notif-dot { width:8px; height:8px; background:var(--accent5); border-radius:50%; display:inline-block; }

  /* Scrollbar */
  ::-webkit-scrollbar { width:4px; height:4px; }
  ::-webkit-scrollbar-track { background:transparent; }
  ::-webkit-scrollbar-thumb { background:var(--border); border-radius:2px; }

  /* Responsive feel */
  @media(max-width:1200px) { .stats-grid { grid-template-columns:repeat(2,1fr); } .courses-grid { grid-template-columns:repeat(2,1fr); } }

  /* VIDEO MODAL */
  .video-modal-overlay {
    position:fixed; inset:0; background:rgba(0,0,0,0.85); backdrop-filter:blur(6px);
    z-index:300; display:none; align-items:center; justify-content:center;
  }
  .video-modal-overlay.open { display:flex; }
  .video-modal {
    background:var(--card); border:1px solid var(--border); border-radius:16px;
    width:820px; max-width:95vw; overflow:hidden;
    animation:slideUp 0.3s ease;
  }
  .video-modal-header {
    display:flex; justify-content:space-between; align-items:center;
    padding:16px 20px; border-bottom:1px solid var(--border);
  }
  .video-modal-header h3 { font-family:'Prompt',sans-serif; font-size:16px; font-weight:700; }
  .video-tabs { display:flex; gap:4px; }
  .video-tab {
    padding:6px 14px; border-radius:6px; border:1px solid var(--border);
    background:transparent; color:var(--text2); cursor:pointer;
    font-family:'Sarabun',sans-serif; font-size:12px; font-weight:600; transition:all 0.2s;
  }
  .video-tab.active { background:rgba(0,212,255,0.1); color:var(--accent); border-color:rgba(0,212,255,0.3); }

  .video-embed-area {
    position:relative; background:#000; padding-bottom:56.25%; height:0; overflow:hidden;
  }
  .video-embed-area iframe { position:absolute; inset:0; width:100%; height:100%; border:none; }
  .video-placeholder {
    position:absolute; inset:0; display:flex; flex-direction:column;
    align-items:center; justify-content:center; gap:12px;
    background:linear-gradient(135deg,#0a1929,#0d2040);
  }
  .play-icon-big {
    width:72px; height:72px; border-radius:50%;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    display:flex; align-items:center; justify-content:center;
    font-size:28px; cursor:pointer;
    box-shadow:0 0 30px rgba(0,212,255,0.4);
    transition:transform 0.2s, box-shadow 0.2s;
  }
  .play-icon-big:hover { transform:scale(1.1); box-shadow:0 0 45px rgba(0,212,255,0.6); }

  .video-url-input-row {
    display:flex; gap:8px; padding:12px 16px;
    background:var(--bg2); border-bottom:1px solid var(--border);
  }
  .video-url-input {
    flex:1; background:var(--card); border:1px solid var(--border);
    border-radius:8px; padding:9px 12px; color:var(--text);
    font-family:'Sarabun',sans-serif; font-size:13px; outline:none;
    transition:border 0.2s;
  }
  .video-url-input:focus { border-color:var(--accent); }
  .video-url-input::placeholder { color:var(--text3); }

  .video-body { padding:16px 20px; }
  .video-progress-track {
    width:100%; height:6px; background:var(--bg2); border-radius:3px;
    overflow:hidden; margin-bottom:12px; cursor:pointer; position:relative;
  }
  .video-progress-fill {
    height:100%; background:linear-gradient(90deg,var(--accent),var(--accent2));
    border-radius:3px; transition:width 0.5s linear; width:0%;
  }
  .video-info-row { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
  .video-timer { font-size:13px; color:var(--text2); font-family:monospace; }
  .video-watched-badge {
    display:flex; align-items:center; gap:6px; font-size:12px; font-weight:700;
    padding:4px 10px; border-radius:20px;
  }
  .badge-watching { background:rgba(0,212,255,0.1); color:var(--accent); }
  .badge-done { background:rgba(16,185,129,0.1); color:var(--accent3); }

  .quiz-unlock-bar {
    padding:12px 16px; border-top:1px solid var(--border);
    display:flex; align-items:center; justify-content:space-between;
  }
  .quiz-unlock-msg { font-size:13px; color:var(--text2); display:flex; align-items:center; gap:8px; }
  .btn-quiz-locked {
    padding:10px 20px; border-radius:8px; border:1px solid var(--border);
    background:var(--bg2); color:var(--text3); cursor:not-allowed;
    font-family:'Sarabun',sans-serif; font-size:13px; font-weight:600;
  }
  .btn-quiz-ready {
    padding:10px 20px; border-radius:8px; border:none;
    background:linear-gradient(135deg,var(--accent3),#34d399); color:#000;
    cursor:pointer; font-family:'Sarabun',sans-serif; font-size:13px; font-weight:700;
    transition:all 0.2s; animation:pulse-glow 2s infinite;
  }
  @keyframes pulse-glow {
    0%,100%{ box-shadow:0 0 0 0 rgba(16,185,129,0.4); }
    50%{ box-shadow:0 0 0 8px rgba(16,185,129,0); }
  }
  .btn-quiz-ready:hover { transform:translateY(-1px); }

  /* VIDEO PLAY icon on course thumb */
  .course-play-btn {
    position:absolute; bottom:8px; right:8px;
    width:32px; height:32px; border-radius:50%;
    background:rgba(0,212,255,0.2); border:1px solid rgba(0,212,255,0.4);
    display:flex; align-items:center; justify-content:center;
    font-size:12px; z-index:2; transition:all 0.2s;
  }
  .course-thumb { position:relative; }
  .course-card:hover .course-play-btn { background:rgba(0,212,255,0.4); transform:scale(1.1); }
  .watched-check {
    position:absolute; top:8px; right:8px;
    width:22px; height:22px; border-radius:50%;
    background:var(--accent3); display:none;
    align-items:center; justify-content:center;
    font-size:11px; z-index:2; color:#000; font-weight:700;
  }
  .watched-check.show { display:flex; }
</style>
</head>
<body>

<!-- SIDEBAR -->
<nav class="sidebar">
  <div class="logo">
    <div class="logo-badge">HRD SYSTEM</div>
    <h1>MedDevice<br>Learning Pro</h1>
    <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</p>
  </div>
  <div class="nav">
    <div class="nav-section">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</div>
    <div class="nav-item active" onclick="showPage('dashboard',this)">
      <span class="icon">üìä</span> Dashboard KPI
    </div>
    <div class="nav-item" onclick="showPage('learning',this)">
      <span class="icon">üéì</span> E-Learning
      <span class="nav-badge">3</span>
    </div>
    <div class="nav-item" onclick="showPage('kpi',this)">
      <span class="icon">üéØ</span> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì KPI
    </div>
    <div class="nav-section">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
    <div class="nav-item" onclick="showPage('employees',this)">
      <span class="icon">üë•</span> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
    </div>
    <div class="nav-item" onclick="showPage('reports',this)">
      <span class="icon">üìà</span> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Training
    </div>
    <div class="nav-section">‡∏£‡∏∞‡∏ö‡∏ö</div>
    <div class="nav-item" onclick="showPage('guide',this)">
      <span class="icon">üìñ</span> ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
    </div>
    <div class="nav-item" onclick="showPage('settings',this)">
      <span class="icon">‚öôÔ∏è</span> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
    </div>
  </div>
  <div class="sidebar-footer">
    <div class="user-card">
      <div class="avatar">‡∏™‡∏°</div>
      <div class="user-info">
        <p>‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏°‡∏µ‡πÅ‡∏£‡∏á</p>
        <p>HR Manager</p>
      </div>
    </div>
  </div>
</nav>

<!-- MAIN -->
<main class="main">
  <div class="topbar">
    <h2 id="page-title">Dashboard KPI Overview</h2>
    <div class="topbar-right">
      <span style="font-size:13px;color:var(--text2)">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2568</span>
      <button class="btn btn-ghost" onclick="alert('Export PDF ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ')">üìÑ Export PDF</button>
      <button class="btn btn-primary" onclick="showPage('guide',null)">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏£‡πå‡∏™</button>
    </div>
  </div>

  <div class="content">

    <!-- ===== DASHBOARD ===== -->
    <div class="page active" id="page-dashboard">
      <div class="stats-grid">
        <div class="stat-card blue">
          <div class="stat-label">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
          <div class="stat-val" style="color:var(--accent)">48</div>
          <div class="stat-sub">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô 3 ‡∏Ñ‡∏ô ‡∏à‡∏≤‡∏Å‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô</div>
          <div class="stat-icon">üë•</div>
        </div>
        <div class="stat-card purple">
          <div class="stat-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô KPI ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
          <div class="stat-val" style="color:var(--accent2)">78.4%</div>
          <div class="stat-sub">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 75% ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô</div>
          <div class="stat-icon">üéØ</div>
        </div>
        <div class="stat-card green">
          <div class="stat-label">Training Complete</div>
          <div class="stat-val" style="color:var(--accent3)">82%</div>
          <div class="stat-sub">39/48 ‡∏Ñ‡∏ô ‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö</div>
          <div class="stat-icon">üéì</div>
        </div>
        <div class="stat-card amber">
          <div class="stat-label">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
          <div class="stat-val" style="color:var(--accent4)">34h</div>
          <div class="stat-sub">‡πÄ‡∏õ‡πâ‡∏≤ 40h/‡∏õ‡∏µ ¬∑ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 6h</div>
          <div class="stat-icon">‚è±Ô∏è</div>
        </div>
      </div>

      <div class="grid-3">
        <div class="card">
          <div class="card-title"><span>üèÜ</span> Top Ranking ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                  <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                  <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                  <th>KPI</th>
                  <th>Training</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><span class="rank-badge rank-1">1</span></td>
                  <td><strong>‡∏ß‡∏¥‡∏†‡∏≤ ‡∏™‡∏∏‡∏Ç‡∏™‡∏°</strong></td>
                  <td style="color:var(--text2)">Sales</td>
                  <td><span class="score-pill score-high">92%</span></td>
                  <td>
                    <div class="progress-mini"><div class="progress-mini-bar" style="width:100%;background:var(--accent3)"></div></div>
                  </td>
                </tr>
                <tr>
                  <td><span class="rank-badge rank-2">2</span></td>
                  <td><strong>‡∏ò‡∏ô‡∏≤ ‡∏î‡∏µ‡∏á‡∏≤‡∏°</strong></td>
                  <td style="color:var(--text2)">Service</td>
                  <td><span class="score-pill score-high">88%</span></td>
                  <td>
                    <div class="progress-mini"><div class="progress-mini-bar" style="width:90%;background:var(--accent3)"></div></div>
                  </td>
                </tr>
                <tr>
                  <td><span class="rank-badge rank-3">3</span></td>
                  <td><strong>‡∏°‡∏≤‡∏•‡∏µ ‡∏£‡∏±‡∏Å‡∏á‡∏≤‡∏ô</strong></td>
                  <td style="color:var(--text2)">Sales</td>
                  <td><span class="score-pill score-high">85%</span></td>
                  <td>
                    <div class="progress-mini"><div class="progress-mini-bar" style="width:85%;background:var(--accent)"></div></div>
                  </td>
                </tr>
                <tr>
                  <td><span class="rank-badge rank-other">4</span></td>
                  <td><strong>‡∏™‡∏°‡∏´‡∏°‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ</strong></td>
                  <td style="color:var(--text2)">Admin</td>
                  <td><span class="score-pill score-mid">76%</span></td>
                  <td>
                    <div class="progress-mini"><div class="progress-mini-bar" style="width:70%;background:var(--accent4)"></div></div>
                  </td>
                </tr>
                <tr>
                  <td><span class="rank-badge rank-other">5</span></td>
                  <td><strong>‡∏Å‡∏≤‡∏ô‡∏î‡∏≤ ‡∏û‡∏£‡∏´‡∏°‡∏°‡∏≤</strong></td>
                  <td style="color:var(--text2)">Service</td>
                  <td><span class="score-pill score-mid">72%</span></td>
                  <td>
                    <div class="progress-mini"><div class="progress-mini-bar" style="width:65%;background:var(--accent4)"></div></div>
                  </td>
                </tr>
                <tr>
                  <td><span class="rank-badge rank-other">6</span></td>
                  <td><strong>‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÅ‡∏Å‡πâ‡∏ß‡∏î‡∏µ</strong></td>
                  <td style="color:var(--text2)">Sales</td>
                  <td><span class="score-pill score-low">61%</span></td>
                  <td>
                    <div class="progress-mini"><div class="progress-mini-bar" style="width:40%;background:var(--accent5)"></div></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="card-title"><span>üó∫Ô∏è</span> Training Heatmap (‡πÅ‡∏ú‡∏ô‡∏Å)</div>
          <div style="display:flex;flex-direction:column;gap:10px;margin-bottom:12px;">
            <div>
              <div style="font-size:12px;color:var(--text2);margin-bottom:6px;">Sales (12 ‡∏Ñ‡∏ô)</div>
              <div style="display:flex;gap:4px;">
                <div class="heat-cell heat-3" style="width:24px;height:24px;">S1</div>
                <div class="heat-cell heat-3" style="width:24px;height:24px;">S2</div>
                <div class="heat-cell heat-2" style="width:24px;height:24px;">S3</div>
                <div class="heat-cell heat-3" style="width:24px;height:24px;">S4</div>
                <div class="heat-cell heat-1" style="width:24px;height:24px;">S5</div>
                <div class="heat-cell heat-3" style="width:24px;height:24px;">S6</div>
                <div class="heat-cell heat-2" style="width:24px;height:24px;">S7</div>
                <div class="heat-cell heat-0" style="width:24px;height:24px;">S8</div>
              </div>
            </div>
            <div>
              <div style="font-size:12px;color:var(--text2);margin-bottom:6px;">Service (10 ‡∏Ñ‡∏ô)</div>
              <div style="display:flex;gap:4px;">
                <div class="heat-cell heat-2" style="width:24px;height:24px;">V1</div>
                <div class="heat-cell heat-3" style="width:24px;height:24px;">V2</div>
                <div class="heat-cell heat-3" style="width:24px;height:24px;">V3</div>
                <div class="heat-cell heat-1" style="width:24px;height:24px;">V4</div>
                <div class="heat-cell heat-2" style="width:24px;height:24px;">V5</div>
                <div class="heat-cell heat-0" style="width:24px;height:24px;">V6</div>
              </div>
            </div>
            <div>
              <div style="font-size:12px;color:var(--text2);margin-bottom:6px;">Admin (8 ‡∏Ñ‡∏ô)</div>
              <div style="display:flex;gap:4px;">
                <div class="heat-cell heat-1" style="width:24px;height:24px;">A1</div>
                <div class="heat-cell heat-2" style="width:24px;height:24px;">A2</div>
                <div class="heat-cell heat-0" style="width:24px;height:24px;">A3</div>
                <div class="heat-cell heat-1" style="width:24px;height:24px;">A4</div>
              </div>
            </div>
          </div>
          <div class="heat-legend">
            <div class="heat-dot heat-3" style="width:12px;height:12px;background:rgba(16,185,129,0.7);border-radius:2px;"></div> ‡∏™‡∏π‡∏á
            <div class="heat-dot" style="background:rgba(16,185,129,0.3);border-radius:2px;"></div> ‡∏Å‡∏•‡∏≤‡∏á
            <div class="heat-dot" style="background:rgba(16,185,129,0.15);border-radius:2px;"></div> ‡∏ï‡πà‡∏≥
            <div class="heat-dot" style="background:rgba(42,53,84,0.5);border-radius:2px;"></div> ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
          </div>
        </div>
      </div>

      <div class="grid-2">
        <div class="card">
          <div class="card-title"><span>üìä</span> KPI Breakdown ‚Äî ‡∏ß‡∏¥‡∏†‡∏≤ ‡∏™‡∏∏‡∏Ç‡∏™‡∏° (Sales)</div>
          <div style="margin-bottom:16px;">
            <div class="kpi-row">
              <div class="kpi-label">Sales Target</div>
              <div class="kpi-bar-wrap"><div class="kpi-bar" style="width:95%;background:linear-gradient(90deg,var(--accent3),#34d399)"></div></div>
              <div class="kpi-score" style="color:var(--accent3)">95</div>
              <div class="kpi-weight">√ó40%</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Service Quality</div>
              <div class="kpi-bar-wrap"><div class="kpi-bar" style="width:88%;background:linear-gradient(90deg,var(--accent),#0099cc)"></div></div>
              <div class="kpi-score" style="color:var(--accent)">88</div>
              <div class="kpi-weight">√ó20%</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Training Completion</div>
              <div class="kpi-bar-wrap"><div class="kpi-bar" style="width:100%;background:linear-gradient(90deg,var(--accent2),#a855f7)"></div></div>
              <div class="kpi-score" style="color:var(--accent2)">100</div>
              <div class="kpi-weight">√ó20%</div>
            </div>
            <div class="kpi-row">
              <div class="kpi-label">Behavior / Loyalty</div>
              <div class="kpi-bar-wrap"><div class="kpi-bar" style="width:85%;background:linear-gradient(90deg,var(--accent4),#fbbf24)"></div></div>
              <div class="kpi-score" style="color:var(--accent4)">85</div>
              <div class="kpi-weight">√ó20%</div>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:rgba(16,185,129,0.08);border-radius:8px;border:1px solid rgba(16,185,129,0.2)">
            <span style="font-size:14px;font-weight:600;">KPI ‡∏£‡∏ß‡∏°</span>
            <span style="font-family:'Prompt',sans-serif;font-size:24px;font-weight:800;color:var(--accent3)">92.2%</span>
            <span style="font-size:13px;color:var(--accent3);font-weight:700;">Grade A ‚≠ê</span>
          </div>
        </div>

        <div class="card">
          <div class="card-title"><span>‚ö†Ô∏è</span> Training Gap (‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£)</div>
          <div style="display:flex;flex-direction:column;gap:10px;">
            <div style="padding:12px;background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:8px;">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                <span style="font-size:13px;font-weight:700;">‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÅ‡∏Å‡πâ‡∏ß‡∏î‡∏µ</span>
                <span class="score-pill score-low">61%</span>
              </div>
              <div style="font-size:12px;color:var(--text2);">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô: Product Knowledge, Compliance</div>
            </div>
            <div style="padding:12px;background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.2);border-radius:8px;">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                <span style="font-size:13px;font-weight:700;">‡∏Å‡∏≤‡∏ô‡∏î‡∏≤ ‡∏û‡∏£‡∏´‡∏°‡∏°‡∏≤</span>
                <span class="score-pill score-mid">72%</span>
              </div>
              <div style="font-size:12px;color:var(--text2);">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô: Anti-Bribery, Soft Skills</div>
            </div>
            <div style="padding:12px;background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.2);border-radius:8px;">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                <span style="font-size:13px;font-weight:700;">‡∏™‡∏°‡∏´‡∏°‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ</span>
                <span class="score-pill score-mid">76%</span>
              </div>
              <div style="font-size:12px;color:var(--text2);">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô: Sales & Service Module 3</div>
            </div>
            <button class="btn btn-primary" style="width:100%;margin-top:4px;" onclick="alert('‡∏™‡πà‡∏á Reminder Email ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥!')">üìß ‡∏™‡πà‡∏á Reminder ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
          </div>
        </div>
      </div>
    </div><!-- end dashboard -->

    <!-- ===== E-LEARNING ===== -->
    <div class="page" id="page-learning">
      <div class="category-tabs">
        <button class="tab active" onclick="filterCourses('all',this)">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (12)</button>
        <button class="tab" onclick="filterCourses('product',this)">üî¨ Product Knowledge</button>
        <button class="tab" onclick="filterCourses('sales',this)">üíº Sales & Service</button>
        <button class="tab" onclick="filterCourses('compliance',this)">‚öñÔ∏è Compliance</button>
        <button class="tab" onclick="filterCourses('soft',this)">üåü Soft Skills</button>
      </div>
      <div class="courses-grid" id="courses-grid">
        <!-- Product -->
        <div class="course-card" data-cat="product" data-course="‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå" onclick="openCourse(this)">
          <div class="course-thumb thumb-blue">
            <span class="thumb-icon">üî¨</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-0">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">PRODUCT KNOWLEDGE</div>
            <div class="course-title">‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>
            <div class="course-meta">‚è±Ô∏è 45 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 15 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:100%;background:var(--accent3)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent3)">100%</div>
              <span class="status-badge status-done">‚úì ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
            </div>
          </div>
        </div>
        <div class="course-card" data-cat="product" data-course="‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏≠‡∏¢. / ISO 13485" onclick="openCourse(this)">
          <div class="course-thumb thumb-blue">
            <span class="thumb-icon">üìã</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-1">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">PRODUCT KNOWLEDGE</div>
            <div class="course-title">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏≠‡∏¢. / ISO 13485</div>
            <div class="course-meta">‚è±Ô∏è 60 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 20 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:65%;background:var(--accent)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent)">65%</div>
              <span class="status-badge status-in">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
            </div>
          </div>
        </div>
        <div class="course-card" data-cat="product" data-course="Competitive Comparison" onclick="openCourse(this)">
          <div class="course-thumb thumb-blue">
            <span class="thumb-icon">‚öîÔ∏è</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-2">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">PRODUCT KNOWLEDGE</div>
            <div class="course-title">Competitive Comparison</div>
            <div class="course-meta">‚è±Ô∏è 30 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 10 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:0%;background:var(--text3)"></div></div>
              <div class="course-progress-pct" style="color:var(--text3)">0%</div>
              <span class="status-badge status-new">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</span>
            </div>
          </div>
        </div>
        <!-- Sales -->
        <div class="course-card" data-cat="sales" data-course="‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ B2B ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•" onclick="openCourse(this)">
          <div class="course-thumb thumb-purple">
            <span class="thumb-icon">üè•</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-3">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">SALES & SERVICE</div>
            <div class="course-title">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ B2B ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</div>
            <div class="course-meta">‚è±Ô∏è 90 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 20 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:100%;background:var(--accent3)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent3)">100%</div>
              <span class="status-badge status-done">‚úì ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
            </div>
          </div>
        </div>
        <div class="course-card" data-cat="sales" data-course="Preventive Maintenance" onclick="openCourse(this)">
          <div class="course-thumb thumb-purple">
            <span class="thumb-icon">üîß</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-4">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">SALES & SERVICE</div>
            <div class="course-title">Preventive Maintenance</div>
            <div class="course-meta">‚è±Ô∏è 60 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 15 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:40%;background:var(--accent4)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent4)">40%</div>
              <span class="status-badge status-in">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
            </div>
          </div>
        </div>
        <!-- Compliance -->
        <div class="course-card" data-cat="compliance" data-course="PDPA ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå" onclick="openCourse(this)">
          <div class="course-thumb thumb-green">
            <span class="thumb-icon">üîê</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-5">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">COMPLIANCE & ETHICS</div>
            <div class="course-title">PDPA ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>
            <div class="course-meta">‚è±Ô∏è 45 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 15 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:100%;background:var(--accent3)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent3)">100%</div>
              <span class="status-badge status-done">‚úì ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
            </div>
          </div>
        </div>
        <div class="course-card" data-cat="compliance" data-course="Anti-Bribery & ‡∏à‡∏£‡∏£‡∏¢‡∏≤‡∏ö‡∏£‡∏£‡∏ì" onclick="openCourse(this)">
          <div class="course-thumb thumb-green">
            <span class="thumb-icon">‚öñÔ∏è</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-6">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">COMPLIANCE & ETHICS</div>
            <div class="course-title">Anti-Bribery & ‡∏à‡∏£‡∏£‡∏¢‡∏≤‡∏ö‡∏£‡∏£‡∏ì</div>
            <div class="course-meta">‚è±Ô∏è 30 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 10 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:0%;background:var(--text3)"></div></div>
              <div class="course-progress-pct" style="color:var(--text3)">0%</div>
              <span class="status-badge status-new">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</span>
            </div>
          </div>
        </div>
        <!-- Soft -->
        <div class="course-card" data-cat="soft" data-course="‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á" onclick="openCourse(this)">
          <div class="course-thumb thumb-amber">
            <span class="thumb-icon">ü§ù</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-7">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">SOFT SKILLS</div>
            <div class="course-title">‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á</div>
            <div class="course-meta">‚è±Ô∏è 60 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 12 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:80%;background:var(--accent3)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent3)">80%</div>
              <span class="status-badge status-done">‚úì ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
            </div>
          </div>
        </div>
        <div class="course-card" data-cat="soft" data-course="Growth Mindset" onclick="openCourse(this)">
          <div class="course-thumb thumb-amber">
            <span class="thumb-icon">üå±</span>
            <div class="course-play-btn">‚ñ∂</div>
            <div class="watched-check" id="wcheck-8">‚úì</div>
          </div>
          <div class="course-body">
            <div class="course-category">SOFT SKILLS</div>
            <div class="course-title">Growth Mindset</div>
            <div class="course-meta">‚è±Ô∏è 45 ‡∏ô‡∏≤‡∏ó‡∏µ ¬∑ üìù 10 ‡∏Ç‡πâ‡∏≠ ¬∑ üéØ ‡∏ú‡πà‡∏≤‡∏ô 80%</div>
            <div class="course-progress">
              <div class="course-progress-bar"><div class="course-progress-fill" style="width:50%;background:var(--accent)"></div></div>
              <div class="course-progress-pct" style="color:var(--accent)">50%</div>
              <span class="status-badge status-in">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== KPI CALC ===== -->
    <div class="page" id="page-kpi">
      <div class="kpi-calc-grid">
        <div>
          <div class="card" style="margin-bottom:16px;">
            <div class="card-title"><span>üéØ</span> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• KPI ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
            <div class="input-group">
              <div class="input-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
              <input type="text" class="input-field" id="emp-name" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" value="‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏°‡∏µ‡πÅ‡∏£‡∏á">
            </div>
            <div class="input-group">
              <div class="input-label">‡πÅ‡∏ú‡∏ô‡∏Å</div>
              <select class="input-field" id="emp-dept">
                <option>Sales</option><option>Service</option><option>Admin</option><option>Warehouse</option>
              </select>
            </div>
            <div class="input-group">
              <div class="input-label">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó)</div>
              <input type="number" class="input-field" id="emp-salary" value="35000">
            </div>
          </div>

          <div class="card">
            <div class="card-title"><span>üìä</span> ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô KPI</div>
            <div class="input-group">
              <div class="input-label">Sales Target (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 40%)</div>
              <div class="input-row">
                <input type="range" min="0" max="100" value="80" id="s1" oninput="calcKPI()" style="flex:1;accent-color:var(--accent3)">
                <span id="s1v" style="width:40px;text-align:right;font-weight:700;color:var(--accent3)">80</span>
              </div>
            </div>
            <div class="input-group">
              <div class="input-label">Service Quality (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 20%)</div>
              <div class="input-row">
                <input type="range" min="0" max="100" value="75" id="s2" oninput="calcKPI()" style="flex:1;accent-color:var(--accent)">
                <span id="s2v" style="width:40px;text-align:right;font-weight:700;color:var(--accent)">75</span>
              </div>
            </div>
            <div class="input-group">
              <div class="input-label">Training Completion (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 20%)</div>
              <div class="input-row">
                <input type="range" min="0" max="100" value="100" id="s3" oninput="calcKPI()" style="flex:1;accent-color:var(--accent2)">
                <span id="s3v" style="width:40px;text-align:right;font-weight:700;color:var(--accent2)">100</span>
              </div>
            </div>
            <div class="input-group">
              <div class="input-label">Behavior / Loyalty (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 20%)</div>
              <div class="input-row">
                <input type="range" min="0" max="100" value="85" id="s4" oninput="calcKPI()" style="flex:1;accent-color:var(--accent4)">
                <span id="s4v" style="width:40px;text-align:right;font-weight:700;color:var(--accent4)">85</span>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card" style="margin-bottom:16px;">
            <div class="card-title"><span>üìà</span> ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå KPI</div>
            <div class="kpi-result-big">
              <div class="kpi-result-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô KPI ‡∏£‡∏ß‡∏°</div>
              <div class="kpi-result-num" id="kpi-total" style="color:var(--accent3)">84.0</div>
              <div class="kpi-result-label">‡∏à‡∏≤‡∏Å 100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
              <div class="kpi-grade" id="kpi-grade" style="color:var(--accent3)">Grade B+ üéâ</div>
            </div>
          </div>

          <div class="card">
            <div class="card-title"><span>üí∞</span> ‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
            <div class="bonus-calc">
              <div class="bonus-row"><span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span><span id="b-base">35,000</span></div>
              <div class="bonus-row"><span>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÇ‡∏ö‡∏ô‡∏±‡∏™ (‡∏ï‡∏≤‡∏° Grade)</span><span id="b-rate" style="color:var(--accent3)">1.5 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span></div>
              <div class="bonus-row"><span>‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö</span><span id="b-bonus" style="color:var(--accent3)">52,500</span></div>
              <div class="bonus-row"><span>% ‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span><span id="b-raise-rate" style="color:var(--accent)">5%</span></div>
              <div class="bonus-row bonus-total">
                <span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</span>
                <span id="b-new" style="color:var(--accent)">36,750</span>
              </div>
            </div>
            <button class="btn btn-primary" style="width:100%;margin-top:12px;" onclick="exportKPI()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheet</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== EMPLOYEES ===== -->
    <div class="page" id="page-employees">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
          <div class="card-title" style="margin-bottom:0"><span>üë•</span> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
          <div style="display:flex;gap:8px;">
            <input type="text" class="input-field" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô..." style="width:200px;padding:8px 12px;font-size:13px;">
            <button class="btn btn-primary">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</button>
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>#</th><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡πÅ‡∏ú‡∏ô‡∏Å</th><th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
                <th>KPI</th><th>Training</th><th>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏≠‡∏ö‡∏£‡∏°</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
              </tr>
            </thead>
            <tbody id="emp-table"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== REPORTS ===== -->
    <div class="page" id="page-reports">
      <div class="grid-2" style="margin-bottom:16px;">
        <div class="card">
          <div class="card-title"><span>üìä</span> ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏• Training ‡∏õ‡∏µ 2568</div>
          <div style="display:flex;flex-direction:column;gap:12px;">
            <div>
              <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:4px;">
                <span>Product Knowledge</span><span style="font-weight:700;color:var(--accent3)">87%</span>
              </div>
              <div class="kpi-bar-wrap" style="height:10px;"><div class="kpi-bar" style="width:87%;background:linear-gradient(90deg,var(--accent),#0099cc)"></div></div>
            </div>
            <div>
              <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:4px;">
                <span>Sales & Service</span><span style="font-weight:700;color:var(--accent3)">79%</span>
              </div>
              <div class="kpi-bar-wrap" style="height:10px;"><div class="kpi-bar" style="width:79%;background:linear-gradient(90deg,var(--accent2),#a855f7)"></div></div>
            </div>
            <div>
              <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:4px;">
                <span>Compliance & Ethics</span><span style="font-weight:700;color:var(--accent3)">91%</span>
              </div>
              <div class="kpi-bar-wrap" style="height:10px;"><div class="kpi-bar" style="width:91%;background:linear-gradient(90deg,var(--accent3),#34d399)"></div></div>
            </div>
            <div>
              <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:4px;">
                <span>Soft Skills</span><span style="font-weight:700;color:var(--accent4)">68%</span>
              </div>
              <div class="kpi-bar-wrap" style="height:10px;"><div class="kpi-bar" style="width:68%;background:linear-gradient(90deg,var(--accent4),#fbbf24)"></div></div>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-title"><span>üìÖ</span> ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏≠‡∏ö‡∏£‡∏° (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</div>
          <div style="display:flex;align-items:flex-end;gap:6px;height:100px;padding-bottom:4px;">
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div style="flex:1;background:var(--bg2);width:100%;border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
                <div style="width:100%;height:40%;background:linear-gradient(to top,var(--accent),#0099cc);border-radius:4px;transition:height 1s;"></div>
              </div>
              <span style="font-size:9px;color:var(--text3)">‡∏°.‡∏Ñ.</span>
            </div>
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div style="flex:1;background:var(--bg2);width:100%;border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
                <div style="width:100%;height:60%;background:linear-gradient(to top,var(--accent),#0099cc);border-radius:4px;"></div>
              </div>
              <span style="font-size:9px;color:var(--text3)">‡∏Å.‡∏û.</span>
            </div>
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div style="flex:1;background:var(--bg2);width:100%;border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
                <div style="width:100%;height:80%;background:linear-gradient(to top,var(--accent),#0099cc);border-radius:4px;"></div>
              </div>
              <span style="font-size:9px;color:var(--text3)">‡∏°‡∏µ.‡∏Ñ.</span>
            </div>
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div style="flex:1;background:var(--bg2);width:100%;border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
                <div style="width:100%;height:55%;background:linear-gradient(to top,var(--accent3),#34d399);border-radius:4px;"></div>
              </div>
              <span style="font-size:9px;color:var(--text3)">‡πÄ‡∏°.‡∏¢.</span>
            </div>
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div style="flex:1;background:var(--bg2);width:100%;border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
                <div style="width:100%;height:70%;background:linear-gradient(to top,var(--accent3),#34d399);border-radius:4px;"></div>
              </div>
              <span style="font-size:9px;color:var(--text3)">‡∏û.‡∏Ñ.</span>
            </div>
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div style="flex:1;background:var(--bg2);width:100%;border-radius:4px;display:flex;align-items:flex-end;overflow:hidden;">
                <div style="width:100%;height:90%;background:linear-gradient(to top,var(--accent2),#a855f7);border-radius:4px;"></div>
              </div>
              <span style="font-size:9px;color:var(--text3)">‡∏°‡∏¥.‡∏¢.</span>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title"><span>üìã</span> ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (Export ‡πÑ‡∏î‡πâ)</div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>Prod.</th><th>Sales</th><th>Comp.</th><th>Soft</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th><th>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th></tr>
            </thead>
            <tbody>
              <tr><td>‡∏ß‡∏¥‡∏†‡∏≤ ‡∏™‡∏∏‡∏Ç‡∏™‡∏°</td><td style="color:var(--accent3)">95</td><td style="color:var(--accent3)">92</td><td style="color:var(--accent3)">98</td><td style="color:var(--accent3)">88</td><td><span class="score-pill score-high">93.3%</span></td><td>42h</td><td><span class="status-badge status-done">‡∏Ñ‡∏£‡∏ö</span></td></tr>
              <tr><td>‡∏ò‡∏ô‡∏≤ ‡∏î‡∏µ‡∏á‡∏≤‡∏°</td><td style="color:var(--accent3)">88</td><td style="color:var(--accent3)">90</td><td style="color:var(--accent3)">85</td><td style="color:var(--accent3)">82</td><td><span class="score-pill score-high">86.3%</span></td><td>38h</td><td><span class="status-badge status-done">‡∏Ñ‡∏£‡∏ö</span></td></tr>
              <tr><td>‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÅ‡∏Å‡πâ‡∏ß‡∏î‡∏µ</td><td style="color:var(--accent4)">62</td><td style="color:var(--accent4)">58</td><td style="color:var(--accent5)">45</td><td style="color:var(--accent4)">70</td><td><span class="score-pill score-low">58.8%</span></td><td>18h</td><td><span class="status-badge status-new">‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</span></td></tr>
            </tbody>
          </table>
        </div>
        <div style="display:flex;gap:8px;margin-top:12px;">
          <button class="btn btn-primary" onclick="alert('Export ‡πÑ‡∏õ Google Sheet ‡πÅ‡∏•‡πâ‡∏ß!')">üìä Export to Sheet</button>
          <button class="btn btn-ghost" onclick="alert('PDF Report ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß!')">üìÑ PDF Report</button>
        </div>
      </div>
    </div>

    <!-- ===== GUIDE ===== -->
    <div class="page" id="page-guide">
      <div class="card">
        <div class="card-title"><span>üìñ</span> ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö HRD ‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô (‡∏ü‡∏£‡∏µ 100%)</div>
        <div style="padding:12px;background:rgba(0,212,255,0.05);border:1px solid rgba(0,212,255,0.2);border-radius:8px;margin-bottom:24px;font-size:13px;line-height:1.8;">
          ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <strong>Google Drive + YouTube + Google Form + Google Sheet + Looker Studio</strong><br>
          ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Software ‡πÉ‡∏î‡πÜ
        </div>

        <div class="guide-steps">
          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">1</div>
              <div class="step-line"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡∏™‡∏£‡πâ‡∏≤‡∏á Google Drive ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö Content</div>
                <span class="step-tool">Google Drive</span>
              </div>
              <div class="step-body">
                ‡πÑ‡∏õ‡∏ó‡∏µ‡πà drive.google.com ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å "HRD_Training_2568" ‚Üí ‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢:
                <ul>
                  <li>üìÅ 01_Product_Knowledge</li>
                  <li>üìÅ 02_Sales_Service</li>
                  <li>üìÅ 03_Compliance_Ethics</li>
                  <li>üìÅ 04_Soft_Skills</li>
                </ul>
                ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î PDF ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤ ‚Üí Share ‚Üí "Anyone with link" ‚Üí Copy Link
              </div>
            </div>
          </div>

          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">2</div>
              <div class="step-line"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô YouTube (Unlisted)</div>
                <span class="step-tool">YouTube Studio</span>
              </div>
              <div class="step-body">
                ‡πÑ‡∏õ studio.youtube.com ‚Üí Upload Video ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Privacy ‡πÄ‡∏õ‡πá‡∏ô <strong>"Unlisted"</strong> (‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô Search ‡πÅ‡∏ï‡πà‡πÅ‡∏ä‡∏£‡πå Link ‡πÑ‡∏î‡πâ)<br>
                ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î ‚Üí Copy Link ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ‚Üí ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ù‡∏±‡∏á‡πÉ‡∏ô Google Site ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á<br>
                <span style="color:var(--accent4);">‚ö†Ô∏è ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡∏±‡πâ‡∏á Private ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏î‡∏π‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</span>
              </div>
            </div>
          </div>

          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">3</div>
              <div class="step-line"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡∏™‡∏£‡πâ‡∏≤‡∏á Google Form ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</div>
                <span class="step-tool">Google Forms</span>
              </div>
              <div class="step-body">
                forms.google.com ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡∏°‡πà ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:
                <ul>
                  <li>Settings ‚Üí Quizzes ‚Üí ‚úÖ Make this a quiz</li>
                  <li>‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 10-20 ‡∏Ç‡πâ‡∏≠ (Multiple Choice)</li>
                  <li>‡πÉ‡∏™‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠ (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏£‡∏ß‡∏° 100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</li>
                  <li>Responses ‚Üí ‚úÖ Collect email addresses</li>
                  <li>Responses ‚Üí Link to Sheet ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet ‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                </ul>
                <div class="code-block">
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° Product Knowledge:<br>
Q: ‡∏Ñ‡πà‡∏≤ ISO ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÉ‡∏î?<br>
A: ISO 13485 ‚úÖ  B: ISO 9001  C: ISO 27001  D: ISO 45001
                </div>
              </div>
            </div>
          </div>

          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">4</div>
              <div class="step-line"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheet ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• KPI</div>
                <span class="step-tool">Google Sheets</span>
              </div>
              <div class="step-body">
                Sheet ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á:
                <ul>
                  <li><strong>Sheet 1: Employees</strong> ‚Äî ‡∏£‡∏´‡∏±‡∏™, ‡∏ä‡∏∑‡πà‡∏≠, ‡πÅ‡∏ú‡∏ô‡∏Å, ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</li>
                  <li><strong>Sheet 2: Quiz_Results</strong> ‚Äî ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏à‡∏≤‡∏Å Google Form ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                  <li><strong>Sheet 3: KPI_Scores</strong> ‚Äî Sales Target, Service, Training, Behavior</li>
                  <li><strong>Sheet 4: Dashboard_Data</strong> ‚Äî ‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏ß‡∏°</li>
                </ul>
                <div class="code-block">
‡∏™‡∏π‡∏ï‡∏£ KPI ‡∏£‡∏ß‡∏°‡πÉ‡∏ô Google Sheet:<br>
=((B2*0.4)+(C2*0.2)+(D2*0.2)+(E2*0.2))<br>
<br>
‡∏™‡∏π‡∏ï‡∏£ Training Completion %:<br>
=COUNTIF(Quiz_Results!B:B,A2)/COUNTA(Courses!A:A)*100
                </div>
              </div>
            </div>
          </div>

          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">5</div>
              <div class="step-line"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡∏™‡∏£‡πâ‡∏≤‡∏á Dashboard ‡∏î‡πâ‡∏ß‡∏¢ Looker Studio</div>
                <span class="step-tool">Looker Studio (Google)</span>
              </div>
              <div class="step-body">
                lookerstudio.google.com ‚Üí Blank Report ‚Üí Add Data Source ‚Üí Google Sheets<br>
                ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Sheet ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á Charts:
                <ul>
                  <li>üìä Scorecard: KPI ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ / Training % / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</li>
                  <li>üìà Bar Chart: Ranking ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</li>
                  <li>üó∫Ô∏è Table: ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ + ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏∏‡∏Å KPI</li>
                  <li>üçï Pie Chart: ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å</li>
                  <li>üìÖ Time Series: ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</li>
                </ul>
                Share ‚Üí "Anyone with link" ‚Üí ‡∏™‡πà‡∏á Link ‡πÉ‡∏´‡πâ HR ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
              </div>
            </div>
          </div>

          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">6</div>
              <div class="step-line"></div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
                <span class="step-tool">Google Sheets Formula</span>
              </div>
              <div class="step-body">
                ‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡∏ï‡∏≤‡∏° Grade ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:
                <div class="code-block">
=IFS(F2>=90,"Grade A ‚Äî ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ 2 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",<br>
     F2>=80,"Grade B ‚Äî ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ 1.5 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",<br>
     F2>=70,"Grade C ‚Äî ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",<br>
     F2>=60,"Grade D ‚Äî ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ 0.5 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",<br>
     TRUE,"Grade F ‚Äî ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÇ‡∏ö‡∏ô‡∏±‡∏™")<br>
<br>
‡∏™‡∏π‡∏ï‡∏£‡πÇ‡∏ö‡∏ô‡∏±‡∏™ (‡∏ö‡∏≤‡∏ó):<br>
=G2*VLOOKUP(F2,GradeTable,2,TRUE)
                </div>
              </div>
            </div>
          </div>

          <div class="step">
            <div class="step-num-wrap">
              <div class="step-num">7</div>
            </div>
            <div class="step-content">
              <div class="step-header">
                <div class="step-title">‡∏™‡πà‡∏á Reminder ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏î‡πâ‡∏ß‡∏¢ Google Apps Script</div>
                <span class="step-tool">Apps Script (‡∏ü‡∏£‡∏µ)</span>
              </div>
              <div class="step-body">
                ‡πÉ‡∏ô Google Sheet ‚Üí Extensions ‚Üí Apps Script ‚Üí ‡∏ß‡∏≤‡∏á Code:
                <div class="code-block">
function sendReminders() {<br>
  const sheet = SpreadsheetApp.getActive()<br>
             .getSheetByName('KPI_Scores');<br>
  const data = sheet.getDataRange().getValues();<br>
  data.forEach((row, i) => {<br>
    if(i===0) return; // skip header<br>
    if(row[3] &lt; 80) { // Training &lt; 80%<br>
      GmailApp.sendEmail(<br>
        row[5], // email column<br>
        "‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Training ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö",<br>
        `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ ${row[1]}, Training ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö`<br>
      );<br>
    }<br>
  });<br>
}<br>
// ‡∏ï‡∏±‡πâ‡∏á Trigger: ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‡πÄ‡∏ß‡∏•‡∏≤ 9:00
                </div>
              </div>
            </div>
          </div>
        </div>

        <div style="padding:20px;background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.2);border-radius:12px;margin-top:8px;">
          <div style="font-family:'Prompt',sans-serif;font-weight:700;font-size:16px;color:var(--accent3);margin-bottom:8px;">‚úÖ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°: 0 ‡∏ö‡∏≤‡∏ó</div>
          <div style="font-size:13px;color:var(--text2);line-height:1.8;">
            Google Drive (‡∏ü‡∏£‡∏µ 15GB) ¬∑ YouTube Unlisted (‡∏ü‡∏£‡∏µ) ¬∑ Google Forms (‡∏ü‡∏£‡∏µ ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î) ¬∑ Google Sheets (‡∏ü‡∏£‡∏µ) ¬∑ Looker Studio (‡∏ü‡∏£‡∏µ) ¬∑ Apps Script (‡∏ü‡∏£‡∏µ)
          </div>
        </div>
      </div>
    </div>

    <!-- ===== SETTINGS ===== -->
    <div class="page" id="page-settings">
      <div class="card">
        <div class="card-title"><span>‚öôÔ∏è</span> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
          <div>
            <div class="input-group">
              <div class="input-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</div>
              <input type="text" class="input-field" value="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÄ‡∏°‡∏î‡∏î‡∏µ‡πÑ‡∏ß‡∏ã‡πå ‡πÇ‡∏õ‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î">
            </div>
            <div class="input-group">
              <div class="input-label">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</div>
              <input type="text" class="input-field" value="2568">
            </div>
            <div class="input-group">
              <div class="input-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏≠‡∏ö‡∏£‡∏°/‡∏õ‡∏µ</div>
              <input type="number" class="input-field" value="40">
            </div>
            <div class="input-group">
              <div class="input-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (%)</div>
              <input type="number" class="input-field" value="80">
            </div>
          </div>
          <div>
            <div class="input-group">
              <div class="input-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å Sales Target (%)</div>
              <input type="number" class="input-field" value="40">
            </div>
            <div class="input-group">
              <div class="input-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å Service Quality (%)</div>
              <input type="number" class="input-field" value="20">
            </div>
            <div class="input-group">
              <div class="input-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å Training (%)</div>
              <input type="number" class="input-field" value="20">
            </div>
            <div class="input-group">
              <div class="input-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å Behavior (%)</div>
              <input type="number" class="input-field" value="20">
            </div>
          </div>
        </div>
        <button class="btn btn-primary" onclick="alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!')" style="margin-top:8px;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
      </div>
    </div>

  </div>
</main>

<!-- QUIZ MODAL -->
<div class="modal-overlay" id="quiz-modal">
  <div class="modal">
    <div class="modal-header">
      <h3 id="quiz-title">‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
      <button class="close-btn" onclick="closeQuiz()">‚úï</button>
    </div>
    <div id="quiz-content"></div>
  </div>
</div>

<!-- VIDEO MODAL -->
<div class="video-modal-overlay" id="video-modal">
  <div class="video-modal">
    <div class="video-modal-header">
      <h3 id="vmodal-title">üìπ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
      <div style="display:flex;align-items:center;gap:10px;">
        <div class="video-tabs">
          <button class="video-tab active" onclick="switchVideoTab('youtube',this)">‚ñ∂ YouTube</button>
          <button class="video-tab" onclick="switchVideoTab('drive',this)">‚òÅ Google Drive</button>
        </div>
        <button class="close-btn" onclick="closeVideoModal()">‚úï</button>
      </div>
    </div>

    <!-- URL Input -->
    <div class="video-url-input-row">
      <input type="text" class="video-url-input" id="video-url-input"
        placeholder="‡∏ß‡∏≤‡∏á YouTube URL ‡∏´‡∏£‡∏∑‡∏≠ Google Drive Share Link ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà... ‡πÄ‡∏ä‡πà‡∏ô https://www.youtube.com/watch?v=..."
        oninput="handleUrlInput(this.value)">
      <button class="btn btn-primary" onclick="loadVideoUrl()">‚ñ∂ ‡πÇ‡∏´‡∏•‡∏î</button>
    </div>

    <!-- Video Embed -->
    <div class="video-embed-area" id="video-embed-area">
      <div class="video-placeholder" id="video-placeholder">
        <div style="font-size:52px;margin-bottom:4px;" id="vplaceholder-icon">üé¨</div>
        <div style="font-family:'Prompt',sans-serif;font-size:16px;font-weight:700;color:var(--text);" id="vplaceholder-title">‡∏ß‡∏≤‡∏á Link ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</div>
        <div style="font-size:13px;color:var(--text2);text-align:center;max-width:360px;line-height:1.6;" id="vplaceholder-sub">
          ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö YouTube (Unlisted) ‡πÅ‡∏•‡∏∞ Google Drive<br>
          ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î "‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        </div>
        <button class="btn btn-primary" style="margin-top:8px;" onclick="loadDemo()">‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
      </div>
    </div>

    <!-- Progress Bar -->
    <div class="video-body">
      <div class="video-info-row">
        <span class="video-timer" id="video-timer">00:00 / --:--</span>
        <span class="video-watched-badge badge-watching" id="video-watch-badge">üëÅ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏π...</span>
      </div>
      <div class="video-progress-track" onclick="seekVideo(event)">
        <div class="video-progress-fill" id="video-progress-fill"></div>
      </div>
      <div style="font-size:12px;color:var(--text3);text-align:center;" id="video-watch-hint">
        ‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 80% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
      </div>
    </div>

    <!-- Quiz Unlock Bar -->
    <div class="quiz-unlock-bar">
      <div class="quiz-unlock-msg" id="quiz-lock-msg">
        üîí <span>‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 80% ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</span>
      </div>
      <button class="btn-quiz-locked" id="btn-start-quiz" disabled>üìù ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
    </div>
  </div>
</div>

<script>
  // Navigation
  function showPage(page, el) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById('page-'+page).classList.add('active');
    if(el) el.classList.add('active');
    const titles = {dashboard:'Dashboard KPI Overview',learning:'E-Learning Courses',kpi:'‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì KPI & ‡πÇ‡∏ö‡∏ô‡∏±‡∏™',employees:'‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',reports:'‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Training',guide:'‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö',settings:'‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤'};
    document.getElementById('page-title').textContent = titles[page] || page;
  }

  // Filter courses
  function filterCourses(cat, el) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    el.classList.add('active');
    document.querySelectorAll('.course-card').forEach(c => {
      c.style.display = (cat==='all' || c.dataset.cat===cat) ? 'block' : 'none';
    });
  }

  // KPI Calculator
  function calcKPI() {
    const s1 = +document.getElementById('s1').value;
    const s2 = +document.getElementById('s2').value;
    const s3 = +document.getElementById('s3').value;
    const s4 = +document.getElementById('s4').value;
    document.getElementById('s1v').textContent = s1;
    document.getElementById('s2v').textContent = s2;
    document.getElementById('s3v').textContent = s3;
    document.getElementById('s4v').textContent = s4;
    const total = (s1*0.4 + s2*0.2 + s3*0.2 + s4*0.2).toFixed(1);
    document.getElementById('kpi-total').textContent = total;
    const salary = +document.getElementById('emp-salary').value || 35000;
    let grade, months, raise;
    if(total>=90){grade='Grade A ‚≠ê‚≠ê';months=2;raise=0.08;}
    else if(total>=80){grade='Grade B+ üéâ';months=1.5;raise=0.05;}
    else if(total>=70){grade='Grade C üëç';months=1;raise=0.03;}
    else if(total>=60){grade='Grade D ‚ö†Ô∏è';months=0.5;raise=0.01;}
    else{grade='Grade F ‚ùå';months=0;raise=0;}
    const color = total>=80?'var(--accent3)':total>=70?'var(--accent4)':'var(--accent5)';
    document.getElementById('kpi-total').style.color = color;
    document.getElementById('kpi-grade').textContent = grade;
    document.getElementById('kpi-grade').style.color = color;
    document.getElementById('b-rate').textContent = months+' ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô';
    const bonus = Math.round(salary*months);
    document.getElementById('b-bonus').textContent = bonus.toLocaleString()+' ‡∏ö‡∏≤‡∏ó';
    document.getElementById('b-raise-rate').textContent = (raise*100)+'%';
    document.getElementById('b-new').textContent = Math.round(salary*(1+raise)).toLocaleString()+' ‡∏ö‡∏≤‡∏ó';
    document.getElementById('b-base').textContent = salary.toLocaleString()+' ‡∏ö‡∏≤‡∏ó';
  }

  function exportKPI() {
    const name = document.getElementById('emp-name').value;
    const total = document.getElementById('kpi-total').textContent;
    alert(`‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheet ‡πÅ‡∏•‡πâ‡∏ß!\n\n‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô: ${name}\nKPI: ${total}%\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà: HRD_Training_2568 > KPI_Scores`);
  }

  // Employees Table
  const employees = [
    {name:'‡∏ß‡∏¥‡∏†‡∏≤ ‡∏™‡∏∏‡∏Ç‡∏™‡∏°', dept:'Sales', pos:'Sales Manager', kpi:92, training:100, hours:42},
    {name:'‡∏ò‡∏ô‡∏≤ ‡∏î‡∏µ‡∏á‡∏≤‡∏°', dept:'Service', pos:'Service Engineer', kpi:88, training:90, hours:38},
    {name:'‡∏°‡∏≤‡∏•‡∏µ ‡∏£‡∏±‡∏Å‡∏á‡∏≤‡∏ô', dept:'Sales', pos:'Sales Rep', kpi:85, training:85, hours:35},
    {name:'‡∏™‡∏°‡∏´‡∏°‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ', dept:'Admin', pos:'Admin Officer', kpi:76, training:70, hours:28},
    {name:'‡∏Å‡∏≤‡∏ô‡∏î‡∏≤ ‡∏û‡∏£‡∏´‡∏°‡∏°‡∏≤', dept:'Service', pos:'Field Service', kpi:72, training:65, hours:25},
    {name:'‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÅ‡∏Å‡πâ‡∏ß‡∏î‡∏µ', dept:'Sales', pos:'Sales Rep', kpi:61, training:40, hours:18},
    {name:'‡∏ô‡∏†‡∏≤ ‡∏°‡∏±‡πà‡∏á‡∏°‡∏µ', dept:'Admin', pos:'HR Officer', kpi:81, training:95, hours:36},
    {name:'‡∏ß‡∏µ‡∏£‡∏ä‡∏±‡∏¢ ‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç', dept:'Service', pos:'Tech Support', kpi:79, training:80, hours:30},
  ];

  function buildEmpTable() {
    const tbody = document.getElementById('emp-table');
    tbody.innerHTML = employees.map((e,i) => {
      const pill = e.kpi>=80?'score-high':e.kpi>=70?'score-mid':'score-low';
      const pct = e.training;
      const pcolor = pct>=80?'var(--accent3)':pct>=60?'var(--accent4)':'var(--accent5)';
      const status = pct>=80?'<span class="status-badge status-done">‡∏Ñ‡∏£‡∏ö</span>':'<span class="status-badge status-new">‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</span>';
      return `<tr>
        <td style="color:var(--text3)">${i+1}</td>
        <td><strong>${e.name}</strong></td>
        <td style="color:var(--text2)">${e.dept}</td>
        <td style="color:var(--text2);font-size:12px">${e.pos}</td>
        <td><span class="score-pill ${pill}">${e.kpi}%</span></td>
        <td><div style="display:flex;align-items:center;gap:6px;"><div class="progress-mini"><div class="progress-mini-bar" style="width:${pct}%;background:${pcolor}"></div></div><span style="font-size:11px;color:${pcolor}">${pct}%</span></div></td>
        <td style="font-size:13px">${e.hours}h</td>
        <td>${status}</td>
      </tr>`;
    }).join('');
  }
  buildEmpTable();

  // Quiz
  const quizData = {
    '‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå': [
      {q:'‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏≠‡∏¢. ‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢?', opts:['Class I ‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î','Class II ‡πÅ‡∏•‡∏∞ III ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô','‡∏ó‡∏∏‡∏Å Class ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á','‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Implantable Device'], ans:2},
      {q:'‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ISO ‡πÉ‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á?', opts:['ISO 9001','ISO 13485','ISO 14001','ISO 27001'], ans:1},
      {q:'‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å?', opts:['‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à','‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Sterilization Date','‡∏ù‡∏∂‡∏Å In-Service Training','‡∏ó‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤ Service'], ans:2},
    ],
    'default': [
      {q:'‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á PDPA?', opts:['‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ','‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó','‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏î Data Breach'], ans:1},
      {q:'Anti-Bribery ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î?', opts:['‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏û‡∏á','‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏ö‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö','‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•','‡∏´‡πâ‡∏≤‡∏°‡∏à‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà'], ans:1},
      {q:'Sales Technique ‡πÉ‡∏î‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ B2B ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•?', opts:['Hard Selling / ‡∏Å‡∏î‡∏î‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏ã‡∏∑‡πâ‡∏≠','Solution Selling / ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤','Price War / ‡πÅ‡∏Ç‡πà‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß','Cold Calling ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'], ans:1},
    ]
  };

  let currentQ = 0, score = 0, totalQ = 0, answered = false, selectedOpt = -1;
  let quizQs = [];

  function openQuiz(courseName) {
    const modal = document.getElementById('quiz-modal');
    document.getElementById('quiz-title').textContent = 'üìù ' + courseName;
    quizQs = quizData[courseName] || quizData['default'];
    totalQ = quizQs.length;
    currentQ = 0; score = 0;
    modal.classList.add('open');
    renderQ();
  }

  function renderQ() {
    answered = false; selectedOpt = -1;
    const q = quizQs[currentQ];
    const opts = q.opts.map((o,i) => `<div class="quiz-opt" id="opt-${i}" onclick="selectOpt(${i})"><span class="opt-circle">${String.fromCharCode(65+i)}</span>${o}</div>`).join('');
    document.getElementById('quiz-content').innerHTML = `
      <div class="quiz-progress">
        <span style="font-size:13px;color:var(--text2)">‡∏Ç‡πâ‡∏≠ ${currentQ+1}/${totalQ}</span>
        <div class="quiz-progress-bar"><div class="quiz-progress-fill" style="width:${(currentQ/totalQ)*100}%"></div></div>
        <span style="font-size:13px;color:var(--text2)">${score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
      </div>
      <div class="quiz-q">${currentQ+1}. ${q.q}</div>
      <div class="quiz-opts">${opts}</div>
      <div class="quiz-nav">
        <span style="font-size:12px;color:var(--text3)">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î Next</span>
        <button class="btn btn-primary" onclick="nextQ()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
      </div>`;
  }

  function selectOpt(i) {
    if(answered) return;
    document.querySelectorAll('.quiz-opt').forEach(o => o.classList.remove('selected'));
    document.getElementById('opt-'+i).classList.add('selected');
    selectedOpt = i;
  }

  function nextQ() {
    if(selectedOpt === -1) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô'); return; }
    if(!answered) {
      answered = true;
      const q = quizQs[currentQ];
      if(selectedOpt === q.ans) {
        document.getElementById('opt-'+selectedOpt).classList.add('correct');
        score++;
      } else {
        document.getElementById('opt-'+selectedOpt).classList.add('wrong');
        document.getElementById('opt-'+q.ans).classList.add('correct');
      }
      setTimeout(() => {
        currentQ++;
        if(currentQ < totalQ) renderQ();
        else showResult();
      }, 800);
    }
  }

  function showResult() {
    const pct = Math.round((score/totalQ)*100);
    const pass = pct >= 80;
    document.getElementById('quiz-content').innerHTML = `
      <div class="quiz-result">
        <div style="font-size:48px;margin-bottom:8px;">${pass?'üéâ':'üòî'}</div>
        <div class="result-score ${pass?'result-pass':'result-fail'}">${pct}%</div>
        <div style="font-size:16px;font-weight:700;margin-bottom:4px;">${pass?'‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢ üéì':'‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'}</div>
        <div style="font-size:14px;color:var(--text2);margin-bottom:24px;">‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å ${score}/${totalQ} ‡∏Ç‡πâ‡∏≠ ¬∑ ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ú‡πà‡∏≤‡∏ô 80%</div>
        <div style="padding:12px;background:${pass?'rgba(16,185,129,0.1)':'rgba(239,68,68,0.1)'};border-radius:8px;font-size:13px;color:var(--text2);margin-bottom:20px;">
          ${pass?'‚úÖ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheet ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥':'‚ö†Ô∏è ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå ‚Äî ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà'}
        </div>
        <div style="display:flex;gap:12px;justify-content:center;">
          <button class="btn btn-ghost" onclick="closeQuiz()">‡∏õ‡∏¥‡∏î</button>
          ${!pass?'<button class="btn btn-primary" onclick="openQuiz(document.getElementById(\'quiz-title\').textContent.replace(\'üìù \',\'\'))">üîÑ ‡∏ó‡∏≥‡πÉ‡∏´‡∏°‡πà</button>':''}
        </div>
      </div>`;
  }

  function closeQuiz() {
    document.getElementById('quiz-modal').classList.remove('open');
  }

  // ===== VIDEO SYSTEM =====
  let currentCourseName = '';
  let videoWatched = {}; // tracks % watched per course
  let videoTimer = null;
  let videoSeconds = 0;
  let totalVideoSeconds = 300; // default 5min demo
  let videoPlaying = false;
  let currentVideoTab = 'youtube';

  function openCourse(cardEl) {
    currentCourseName = cardEl.dataset.course;
    document.getElementById('vmodal-title').textContent = 'üìπ ' + currentCourseName;
    document.getElementById('video-url-input').value = '';
    resetVideoState();
    document.getElementById('video-modal').classList.add('open');
    // Restore previous watch progress
    const prev = videoWatched[currentCourseName] || 0;
    if(prev > 0) {
      videoSeconds = Math.floor(prev * totalVideoSeconds / 100);
      updateVideoUI(prev);
      if(prev >= 80) unlockQuiz();
    }
  }

  function closeVideoModal() {
    stopVideoTimer();
    // If embed iframe present, remove it to stop playback
    const area = document.getElementById('video-embed-area');
    const iframe = area.querySelector('iframe');
    if(iframe) iframe.remove();
    document.getElementById('video-placeholder').style.display = 'flex';
    document.getElementById('video-modal').classList.remove('open');
  }

  function resetVideoState() {
    stopVideoTimer();
    videoSeconds = 0; videoPlaying = false;
    document.getElementById('video-progress-fill').style.width = '0%';
    document.getElementById('video-timer').textContent = '00:00 / --:--';
    document.getElementById('video-watch-badge').className = 'video-watched-badge badge-watching';
    document.getElementById('video-watch-badge').textContent = 'üëÅ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏π...';
    document.getElementById('video-watch-hint').textContent = '‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 80% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö';
    document.getElementById('quiz-lock-msg').innerHTML = 'üîí <span>‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 80% ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</span>';
    const btn = document.getElementById('btn-start-quiz');
    btn.className = 'btn-quiz-locked'; btn.disabled = true;
    btn.textContent = 'üìù ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö';
    btn.onclick = null;
    document.getElementById('video-placeholder').style.display = 'flex';
    const area = document.getElementById('video-embed-area');
    const iframe = area.querySelector('iframe');
    if(iframe) iframe.remove();
  }

  function switchVideoTab(tab, el) {
    currentVideoTab = tab;
    document.querySelectorAll('.video-tab').forEach(t => t.classList.remove('active'));
    el.classList.add('active');
    const ph = document.getElementById('vplaceholder-sub');
    if(tab === 'youtube') {
      ph.innerHTML = '‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö YouTube (Unlisted) ‡πÅ‡∏•‡∏∞ YouTube ‡∏õ‡∏Å‡∏ï‡∏¥<br>‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î "‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô';
      document.getElementById('video-url-input').placeholder = '‡∏ß‡∏≤‡∏á YouTube URL ‡πÄ‡∏ä‡πà‡∏ô https://www.youtube.com/watch?v=...';
    } else {
      ph.innerHTML = '‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Google Drive Share Link<br>‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ "Anyone with link can view" ‡∏Å‡πà‡∏≠‡∏ô';
      document.getElementById('video-url-input').placeholder = '‡∏ß‡∏≤‡∏á Google Drive Share Link ‡πÄ‡∏ä‡πà‡∏ô https://drive.google.com/file/d/...';
    }
  }

  function handleUrlInput(val) {
    // auto-detect type
    if(val.includes('drive.google.com')) {
      currentVideoTab = 'drive';
      document.querySelectorAll('.video-tab').forEach((t,i) => t.classList.toggle('active', i===1));
    } else if(val.includes('youtube.com') || val.includes('youtu.be')) {
      currentVideoTab = 'youtube';
      document.querySelectorAll('.video-tab').forEach((t,i) => t.classList.toggle('active', i===0));
    }
  }

  function loadVideoUrl() {
    const raw = document.getElementById('video-url-input').value.trim();
    if(!raw) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á Link ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏Å‡πà‡∏≠‡∏ô'); return; }
    let embedUrl = '';
    if(raw.includes('youtube.com/watch')) {
      const id = new URLSearchParams(raw.split('?')[1]).get('v');
      embedUrl = `https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;
    } else if(raw.includes('youtu.be/')) {
      const id = raw.split('youtu.be/')[1].split('?')[0];
      embedUrl = `https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;
    } else if(raw.includes('drive.google.com/file/d/')) {
      const id = raw.split('/file/d/')[1].split('/')[0];
      embedUrl = `https://drive.google.com/file/d/${id}/preview`;
    } else {
      alert('‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å URL ‡∏ô‡∏µ‡πâ ‚Äî ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ YouTube ‡∏´‡∏£‡∏∑‡∏≠ Google Drive link');
      return;
    }
    embedVideo(embedUrl, true);
  }

  function loadDemo() {
    // Demo with a real YouTube embed (Big Buck Bunny - open source)
    embedVideo('https://www.youtube.com/embed/aqz-KE-bpKQ?autoplay=1&rel=0', false);
    document.getElementById('video-url-input').value = 'https://www.youtube.com/watch?v=aqz-KE-bpKQ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)';
    totalVideoSeconds = 40; // short demo
  }

  function embedVideo(url, isReal) {
    const area = document.getElementById('video-embed-area');
    document.getElementById('video-placeholder').style.display = 'none';
    const old = area.querySelector('iframe');
    if(old) old.remove();
    const iframe = document.createElement('iframe');
    iframe.src = url;
    iframe.allow = 'autoplay; fullscreen';
    iframe.allowFullscreen = true;
    area.appendChild(iframe);
    // Start simulated progress tracker
    startVideoTimer();
  }

  function startVideoTimer() {
    stopVideoTimer();
    videoPlaying = true;
    videoTimer = setInterval(() => {
      if(!videoPlaying) return;
      videoSeconds++;
      const pct = Math.min(100, Math.round(videoSeconds / totalVideoSeconds * 100));
      videoWatched[currentCourseName] = Math.max(videoWatched[currentCourseName] || 0, pct);
      updateVideoUI(pct);
      if(pct >= 80 && document.getElementById('btn-start-quiz').disabled) unlockQuiz();
      if(pct >= 100) { stopVideoTimer(); }
    }, 1000);
  }

  function stopVideoTimer() {
    if(videoTimer) { clearInterval(videoTimer); videoTimer = null; }
    videoPlaying = false;
  }

  function updateVideoUI(pct) {
    document.getElementById('video-progress-fill').style.width = pct + '%';
    const elapsed = videoSeconds;
    const total = totalVideoSeconds;
    const fmt = s => String(Math.floor(s/60)).padStart(2,'0')+':'+String(s%60).padStart(2,'0');
    document.getElementById('video-timer').textContent = fmt(Math.min(elapsed,total)) + ' / ' + fmt(total);
    if(pct >= 100) {
      document.getElementById('video-watch-badge').className = 'video-watched-badge badge-done';
      document.getElementById('video-watch-badge').textContent = '‚úÖ ‡∏î‡∏π‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß!';
      // Mark card
      const cards = document.querySelectorAll('.course-card');
      cards.forEach((c,i) => {
        if(c.dataset.course === currentCourseName) {
          const chk = c.querySelector('.watched-check');
          if(chk) chk.classList.add('show');
        }
      });
    } else if(pct >= 80) {
      document.getElementById('video-watch-badge').className = 'video-watched-badge badge-done';
      document.getElementById('video-watch-badge').textContent = 'üîì ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö';
    }
    document.getElementById('video-watch-hint').textContent = `‡∏î‡∏π‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ${pct}% ${pct>=80?'‚úÖ ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß!':'‚Äî ‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á 80%'}`;
  }

  function unlockQuiz() {
    document.getElementById('quiz-lock-msg').innerHTML = 'üîì <span style="color:var(--accent3)">‡∏î‡∏π‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</span>';
    const btn = document.getElementById('btn-start-quiz');
    btn.className = 'btn-quiz-ready'; btn.disabled = false;
    btn.textContent = 'üìù ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö';
    btn.onclick = () => { closeVideoModal(); openQuiz(currentCourseName); };
  }

  function seekVideo(e) {
    const bar = e.currentTarget;
    const pct = e.offsetX / bar.offsetWidth;
    videoSeconds = Math.floor(pct * totalVideoSeconds);
    updateVideoUI(Math.round(pct*100));
  }

  // ===== END VIDEO SYSTEM =====

  // Init
  calcKPI();
</script>
</body>
</html>
